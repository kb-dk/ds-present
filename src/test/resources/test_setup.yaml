#
# Only used for unit testing
#
config:
  # List of backing storages. The real URLs should be overridden in ds-present-environment.yaml
  storages:
    - test:
        order: sequential
        backends:
          # Problematic: Can we rely on the test being started with the working folder at the root of the project?
          - folder:
              root: 'src/test/resources/xml'
          - folder:
              root: 'src/test/resources/xml/corpus'

  # Settings for handling at the record level
  record:
    id:
      # Pattern for acceptable record IDs. Must contain exactly 2 capturing group, the first being the collection prefix
      # and the second being the collection-specifix par of the ID
      # Mandatory. Suggested value: '$([a-z][0-9][.]):([a-z][0-9][.-_])$', e.g. 'images.dsfl:image1234'
      pattern: '^([a-z0-9.]+):([a-z0-9._-]+)$'

  # The collections available for this instance of ds-present 
  collections:
    # Straight forward collection with the core format being MODS
    - dsfl: # ds-present internal
        prefix: 'local' # The prefix to match on incoming IDs
        description: 'Local records, mostly biographical'
        # Different views on the material. Note that all collections has at least mods, jsonld and solrjson as views
        views:
          - mods:
              mime: 'application/xml'
              transformers:
                - identity: # No transformation steps as mods is the core format for images-dsfl
          - jsonld:
              mime: 'application/json'
              transformers:
                - xslt:
                    stylesheet: 'xslt/mods2schemaorg.xsl'
          - solrjson:
              mime: 'application/json'
              transformers:
                - xslt:
                    stylesheet: 'xslt/mods2solr.xsl'
          - raw:
              mime: 'text/plain'
              transformers:
                - fail:
                    message: 'Raw format contains confidential information and cannot be delivered'
